(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[3],{122:function(e,s,a){e.exports={messagesWrap:"Messages_messagesWrap__3hUqa",messageWrap:"Messages_messageWrap__2ITiA",messageWrapOwner:"Messages_messageWrapOwner__1BnMH",userPhotoContainer:"Messages_userPhotoContainer__bsPsX",userName:"Messages_userName__2QUC_",message:"Messages_message__2b9gd",deleteMessageButton:"Messages_deleteMessageButton__1fXmX",myMessage:"Messages_myMessage__1nJmM",postsForm:"Messages_postsForm__2ae_M",messageInput:"Messages_messageInput__3otbB",sendMessage:"Messages_sendMessage__I4_8u",userPhoto:"Messages_userPhoto__qWMuV",errorMessage:"Messages_errorMessage__Vb3nM",messagesForm:"Messages_messagesForm__T1uMJ"}},123:function(e,s,a){e.exports={chatContainer:"Chat_chatContainer__1itWt",messagesWrap:"Chat_messagesWrap__11k-Z",messageWrap:"Chat_messageWrap__23j05",messageWrapOwner:"Chat_messageWrapOwner__2skcO",userPhotoContainer:"Chat_userPhotoContainer__w2vpC",userName:"Chat_userName__1NE6V",message:"Chat_message__2Jls5",myMessage:"Chat_myMessage__11ZHY",postsForm:"Chat_postsForm__MiIG0",messageInput:"Chat_messageInput__1e4d7",sendMessage:"Chat_sendMessage__1TpcS",userPhoto:"Chat_userPhoto__1UBwE",errorMessage:"Chat_errorMessage__1yGdu",messagesInputBlock:"Chat_messagesInputBlock__2qdry"}},124:function(e,s,a){e.exports={dialogsWrap:"Dialogs_dialogsWrap__2QX5N",commonChatBtn:"Dialogs_commonChatBtn__13kzD",userName:"Dialogs_userName__1f5V2",dialog:"Dialogs_dialog__3X4yL",avatar:"Dialogs_avatar__2lVKW"}},125:function(e,s,a){e.exports={messageWrap:"Message_messageWrap__fEmYW",messageWrapOwner:"Message_messageWrapOwner__3q3UV",userPhotoContainer:"Message_userPhotoContainer__4jdAY",userName:"Message_userName__1kNjM",message:"Message_message__2XQq1",menuMessage:"Message_menuMessage__2h4EW",messageText:"Message_messageText__udswY",messageTextOwner:"Message_messageTextOwner__1RC2S",viewedMessageIcon:"Message_viewedMessageIcon__Hzfzs",userPhoto:"Message_userPhoto__3leSj",messagesForm:"Message_messagesForm__1N9ke",deleteShure:"Message_deleteShure__2KIt-",activeDeleteMenu:"Message_activeDeleteMenu__31LwI",actionWindow:"Message_actionWindow__jb21q",actionWindowButtons:"Message_actionWindowButtons__3lPYe",burgerMenu:"Message_burgerMenu__WcRkl",burgerMenuOwner:"Message_burgerMenuOwner__1oOLH",burgerMenuCentralElem:"Message_burgerMenuCentralElem__3MBOe",menuMessageSmallScreen:"Message_menuMessageSmallScreen__2MgdN",menuMessageSmallScreenOwner:"Message_menuMessageSmallScreenOwner__HuqCT",menuMessageSmallActive:"Message_menuMessageSmallActive__3j5YD"}},127:function(e,s,a){"use strict";a.r(s);var t=a(1),n=a.n(t),r=a(123),c=a.n(r),o=a(124),i=a.n(o),g=a(30),l=a(7),u=a(54),d=a(22),m=a(13),_=a(0),j=n.a.memo((function(e){Object(t.useEffect)((function(){e.getDialogs()}),[]);var s=Object(l.c)(),a=e.dialogs,n=null===a||void 0===a?void 0:a.map((function(s){return Object(_.jsx)(M,{id:s.id,name:s.userName,url:s.photos.small,getDialogMessages:e.getDialogMessages},s.id)}));return Object(_.jsxs)("div",{className:i.a.dialogsWrap,children:[Object(_.jsx)("div",{className:i.a.commonChatBtn,children:Object(_.jsx)(m.a,{click:function(){s(d.b.cleanDialogMessages()),s(Object(u.c)())},value:"Common chat",buttonType:"commonChat"})}),n]})})),M=n.a.memo((function(e){var s=Object(l.c)();return Object(_.jsxs)("div",{className:i.a.dialog,children:[Object(_.jsx)("div",{className:i.a.avatar,onClick:function(){s(Object(u.d)()),e.getDialogMessages(e.id),s(d.b.setDialogId(e.id)),s(Object(d.h)(e.id))},children:Object(_.jsx)("img",{src:e.url||g.a,alt:"User"})}),Object(_.jsx)("div",{className:i.a.userName,children:e.name.slice(0,5)+"..."})]})})),b=j,h=a(8),O=a(122),p=a.n(O),v=a(125),x=a.n(v),f=a(9),w=a.p+"static/media/delete-icon.4663c0b5.png",N=a.p+"static/media/spam-icon.c8885cb2.png",C=a(32),I=a(3),W=n.a.memo((function(e){var s=Object(t.useState)(!1),a=Object(h.a)(s,2),n=a[0],r=a[1],c=Object(t.useState)(!1),o=Object(h.a)(c,2),i=o[0],u=o[1],d=Object(t.useState)("delete"),m=Object(h.a)(d,2),j=m[0],M=m[1],b=Object(t.useState)(null),O=Object(h.a)(b,2),p=O[0],v=O[1],W=Object(t.useState)(!1),D=Object(h.a)(W,2),T=D[0],y=D[1],B=Object(t.useState)(!1),P=Object(h.a)(B,2),k=P[0],E=P[1];Object(l.d)((function(e){return e.profilePage.profileInfo}));Object(t.useEffect)((function(){setTimeout((function(){C.a.isViewedMessage(e.id).then((function(e){y(e.data)}))}),5e3*Math.random())}),[]),Object(t.useEffect)((function(){setTimeout((function(){e.isMe?I.c.getProfileData(e.ownerId).then((function(e){return v(e.data.photos.small)})):I.c.getProfileData(e.senderId).then((function(e){return v(e.data.photos.small)}))}),5e3*Math.random())}),[]);return Object(_.jsx)("div",{children:i?Object(_.jsx)(S,{actionText:"Message was deleted.",action1:function(){e.restoreMessage(e.id),u(!1),r(!1),M("delete")},actionWindowType:j,valueButton1:"Restore"}):Object(_.jsxs)("div",{className:x.a.messageWrap+" "+(e.isMe&&x.a.messageWrapOwner),children:[Object(_.jsx)("div",{className:x.a.userPhotoContainer,children:Object(_.jsx)(f.b,{to:"/profile/".concat(e.id),children:Object(_.jsx)("img",{className:x.a.userPhoto,src:e.ava||p||g.a,alt:"AVA"})})}),Object(_.jsx)("div",{className:x.a.userName,children:e.userName}),Object(_.jsxs)("div",{className:x.a.message+" "+(e.isMe&&x.a.myMessage),children:[Object(_.jsxs)("span",{className:x.a.messageText+" "+(e.isMe&&x.a.messageTextOwner),children:[e.message,T&&Object(_.jsx)("span",{className:x.a.viewedMessageIcon,children:"\u2713"})]}),Object(_.jsx)("div",{className:x.a.burgerMenu+" "+(e.isMe&&x.a.burgerMenuOwner),onClick:function(){E(!k)},children:Object(_.jsx)("div",{className:x.a.burgerMenuCentralElem})})]}),Object(_.jsx)("div",{className:x.a.deleteShure+" "+(n&&x.a.activeDeleteMenu),children:Object(_.jsx)(S,{actionText:"Are you shure?",action1:function(){e.deleteMessage(e.id),u(!0),M("restore")},action2:function(){r(!1)},actionWindowType:j,valueButton1:"Yes",valueButton2:"No"})}),Object(_.jsx)("div",{className:x.a.menuMessageSmallScreen+" "+(e.isMe&&x.a.menuMessageSmallScreenOwner)+" "+(k&&x.a.menuMessageSmallActive),children:Object(_.jsxs)("ul",{children:[Object(_.jsxs)("li",{onClick:function(){r(!0),E(!1)},children:[Object(_.jsx)("img",{src:w,alt:""}),Object(_.jsx)("span",{children:"Delete message"})]}),Object(_.jsxs)("li",{onClick:function(){console.log("spam"),E(!1)},children:[Object(_.jsx)("img",{src:N,alt:""}),Object(_.jsx)("span",{children:"Add to spam"})]})]})})]})})})),S=function(e){return Object(_.jsxs)("div",{className:x.a.actionWindow,children:[Object(_.jsx)("span",{children:e.actionText}),Object(_.jsxs)("div",{className:x.a.actionWindowButtons,children:[Object(_.jsx)(m.a,{value:e.valueButton1,click:e.action1,buttonType:"actionWindow"}),"delete"===e.actionWindowType&&Object(_.jsx)(m.a,{value:e.valueButton2||"",click:e.action2,buttonType:"actionWindow"})]})]})},D=a(66),T=n.a.memo((function(e){var s=Object(t.useState)(""),a=Object(h.a)(s,2),n=a[0],r=a[1],c=Object(t.useState)(null),o=Object(h.a)(c,2),i=o[0],g=o[1],j=Object(l.c)();return Object(_.jsxs)("div",{className:p.a.messagesForm,children:[Object(_.jsx)("div",{className:p.a.messageInput,children:Object(_.jsx)(D.a,{value:n,onChange:function(e){r(e.target.value)}})}),Object(_.jsx)("div",{className:p.a.errorMessage,children:i}),Object(_.jsx)(m.a,{click:function(){!n||n.length<1?g("You can not send an empty message"):n.length>=100?g("Max length is 100 symbols"):(e.chatMessages?j(Object(u.b)(n)):j(Object(d.g)(n,e.currentDialogId)),r(""),g(null))},value:"Send message",buttonType:"sendMessage",disabled:!!e.chatMessages&&"ready"!==e.status})]})})),y=n.a.memo((function(e){var s,a,n=Object(t.useState)(!0),r=Object(h.a)(n,2),c=r[0],o=r[1],i=Object(t.useRef)(null);Object(t.useEffect)((function(){var e;c&&(null===(e=i.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[e.chatMessages,e.dialogMessages]);var g=null===(s=e.chatMessages)||void 0===s?void 0:s.map((function(s){return Object(_.jsx)(W,{id:s.userId,isMe:s.userId===e.ownerId,message:s.message,ava:s.photo,userName:s.userName,messageType:"commonChat",deleteMessage:e.deleteMessage,senderId:1,recipientId:1,restoreMessage:e.restoreMessage,ownerId:e.ownerId},s.id)})),l=null===(a=e.dialogMessages)||void 0===a?void 0:a.map((function(s){return Object(_.jsx)(W,{id:s.id,isMe:s.senderId===e.ownerId,message:s.body,ava:null,userName:s.senderName,messageType:"dialog",deleteMessage:e.deleteMessage,senderId:s.senderId,recipientId:s.recipientId,restoreMessage:e.restoreMessage,ownerId:e.ownerId},s.id.toString())}));e.status&&"error"===e.status&&console.log("Error Chat");return Object(_.jsxs)("div",{className:p.a.messagesWithInput,children:[Object(_.jsxs)("div",{className:p.a.messagesWrap,onScroll:function(e){o(!1),e.target.scrollTopMax-e.target.scrollTop<100&&o(!0)},children:["error"===(e.status&&e.status)&&Object(_.jsx)("div",{style:{color:"red",fontSize:"20px"},children:"Some error"}),g||l,Object(_.jsx)("div",{ref:i})]}),Object(_.jsx)(T,{currentDialogId:e.currentDialogId,chatMessages:e.chatMessages,status:e.status})]})})),B=n.a.memo((function(e){return Object(_.jsxs)("div",{className:c.a.chatContainer,children:[Object(_.jsx)(b,{dialogs:e.dialogs,getDialogs:e.getDialogs,getDialogMessages:e.getDialogMessages}),Object(_.jsx)(y,{chatMessages:e.chatMessages,dialogMessages:e.dialogMessages,status:e.chatStatus,ownerId:e.ownerId,currentDialogId:e.currentDialogId,deleteMessage:e.deleteMessage,restoreMessage:e.restoreMessage})]})}));s.default=B}}]);
//# sourceMappingURL=3.9503c640.chunk.js.map