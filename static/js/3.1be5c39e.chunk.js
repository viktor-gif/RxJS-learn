(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[3],{121:function(e,s,a){e.exports={messagesWrap:"Messages_messagesWrap__3hUqa",messageWrap:"Messages_messageWrap__2ITiA",messageWrapOwner:"Messages_messageWrapOwner__1BnMH",userPhotoContainer:"Messages_userPhotoContainer__bsPsX",userName:"Messages_userName__2QUC_",message:"Messages_message__2b9gd",deleteMessageButton:"Messages_deleteMessageButton__1fXmX",myMessage:"Messages_myMessage__1nJmM",postsForm:"Messages_postsForm__2ae_M",messageInput:"Messages_messageInput__3otbB",sendMessage:"Messages_sendMessage__I4_8u",userPhoto:"Messages_userPhoto__qWMuV",errorMessage:"Messages_errorMessage__Vb3nM",messagesForm:"Messages_messagesForm__T1uMJ"}},122:function(e,s,a){e.exports={chatContainer:"Chat_chatContainer__1itWt",messagesWrap:"Chat_messagesWrap__11k-Z",messageWrap:"Chat_messageWrap__23j05",messageWrapOwner:"Chat_messageWrapOwner__2skcO",userPhotoContainer:"Chat_userPhotoContainer__w2vpC",userName:"Chat_userName__1NE6V",message:"Chat_message__2Jls5",myMessage:"Chat_myMessage__11ZHY",postsForm:"Chat_postsForm__MiIG0",messageInput:"Chat_messageInput__1e4d7",sendMessage:"Chat_sendMessage__1TpcS",userPhoto:"Chat_userPhoto__1UBwE",errorMessage:"Chat_errorMessage__1yGdu",messagesInputBlock:"Chat_messagesInputBlock__2qdry"}},123:function(e,s,a){e.exports={dialogsWrap:"Dialogs_dialogsWrap__2QX5N",commonChatBtn:"Dialogs_commonChatBtn__13kzD",userName:"Dialogs_userName__1f5V2",dialog:"Dialogs_dialog__3X4yL",avatar:"Dialogs_avatar__2lVKW"}},124:function(e,s,a){e.exports={messageWrap:"Message_messageWrap__fEmYW",messageWrapOwner:"Message_messageWrapOwner__3q3UV",userPhotoContainer:"Message_userPhotoContainer__4jdAY",userName:"Message_userName__1kNjM",message:"Message_message__2XQq1",menuMessage:"Message_menuMessage__2h4EW",messageTextOwner:"Message_messageTextOwner__1RC2S",menuMessageOwner:"Message_menuMessageOwner__3f0hz",messageText:"Message_messageText__udswY",viewedMessageIcon:"Message_viewedMessageIcon__Hzfzs",userPhoto:"Message_userPhoto__3leSj",messagesForm:"Message_messagesForm__1N9ke",deleteShure:"Message_deleteShure__2KIt-",activeDeleteMenu:"Message_activeDeleteMenu__31LwI",actionWindow:"Message_actionWindow__jb21q",actionWindowButtons:"Message_actionWindowButtons__3lPYe"}},126:function(e,s,a){"use strict";a.r(s);var t=a(1),n=a.n(t),o=a(122),c=a.n(o),r=a(123),i=a.n(r),g=a(30),l=a(7),d=a(53),u=a(22),m=a(13),_=a(0),j=n.a.memo((function(e){Object(t.useEffect)((function(){e.getDialogs()}),[]);var s=Object(l.c)(),a=e.dialogs,n=null===a||void 0===a?void 0:a.map((function(s){return Object(_.jsx)(M,{id:s.id,name:s.userName,url:s.photos.small,getDialogMessages:e.getDialogMessages},s.id)}));return Object(_.jsxs)("div",{className:i.a.dialogsWrap,children:[Object(_.jsx)("div",{className:i.a.commonChatBtn,children:Object(_.jsx)(m.a,{click:function(){s(u.b.cleanDialogMessages()),s(Object(d.c)())},value:"Common chat",buttonType:"commonChat"})}),n]})})),M=n.a.memo((function(e){var s=Object(l.c)();return Object(_.jsxs)("div",{className:i.a.dialog,children:[Object(_.jsx)("div",{className:i.a.avatar,onClick:function(){s(Object(d.d)()),e.getDialogMessages(e.id),s(u.b.setDialogId(e.id)),s(Object(u.h)(e.id))},children:Object(_.jsx)("img",{src:e.url||g.a,alt:"User"})}),Object(_.jsx)("div",{className:i.a.userName,children:e.name.slice(0,5)+"..."})]})})),b=j,h=a(8),O=a(121),p=a.n(O),v=a(124),x=a.n(v),f=a(9),I=a.p+"static/media/delete-icon.4663c0b5.png",w=a.p+"static/media/spam-icon.c8885cb2.png",N=a(32),W=a(3),C=n.a.memo((function(e){var s=Object(t.useState)(!1),a=Object(h.a)(s,2),n=a[0],o=a[1],c=Object(t.useState)(!1),r=Object(h.a)(c,2),i=r[0],d=r[1],u=Object(t.useState)("delete"),m=Object(h.a)(u,2),j=m[0],M=m[1],b=Object(t.useState)(null),O=Object(h.a)(b,2),p=(O[0],O[1],Object(t.useState)(null)),v=Object(h.a)(p,2),C=v[0],D=v[1],T=Object(t.useState)(!1),P=Object(h.a)(T,2),S=P[0],B=P[1];console.log(C);Object(l.c)();var k=Object(l.d)((function(e){return e.profilePage.profileInfo}));console.log(k),Object(t.useEffect)((function(){N.a.isViewedMessage(e.id).then((function(e){B(e.data)}))}),[]),Object(t.useEffect)((function(){e.isMe?W.c.getProfileData(e.ownerId).then((function(e){return D(e.data.photos.small)})):W.c.getProfileData(e.senderId).then((function(e){return D(e.data.photos.small)}))}),[]);e.isMe?e.recipientId:e.senderId;return Object(_.jsx)("div",{children:i?Object(_.jsx)(y,{actionText:"Message was deleted.",action1:function(){e.restoreMessage(e.id),d(!1),o(!1),M("delete")},actionWindowType:j,valueButton1:"Restore"}):Object(_.jsxs)("div",{className:x.a.messageWrap+" "+(e.isMe&&x.a.messageWrapOwner),children:[Object(_.jsx)("div",{className:x.a.userPhotoContainer,children:Object(_.jsx)(f.b,{to:"/profile/".concat(e.id),children:Object(_.jsx)("img",{className:x.a.userPhoto,src:e.ava||C||g.a,alt:"AVA"})})}),Object(_.jsx)("div",{className:x.a.userName,children:e.userName}),Object(_.jsxs)("div",{className:x.a.message+" "+(e.isMe&&x.a.myMessage),children:[Object(_.jsxs)("span",{className:x.a.messageText+" "+(e.isMe&&x.a.messageTextOwner),children:[e.message,S&&Object(_.jsx)("span",{className:x.a.viewedMessageIcon,children:"\u2713"})]}),"dialog"===e.messageType&&Object(_.jsxs)("div",{className:x.a.menuMessage+" "+(e.isMe&&x.a.menuMessageOwner),children:[Object(_.jsx)("img",{className:x.a.deleteIconPic,src:I,alt:"delete",onClick:function(){return o(!0)}}),Object(_.jsx)("img",{className:x.a.spamIconPic,src:w,alt:"spam",onClick:function(){console.log("spam")}})]})]}),Object(_.jsx)("div",{className:x.a.deleteShure+" "+(n&&x.a.activeDeleteMenu),children:Object(_.jsx)(y,{actionText:"Are you shure?",action1:function(){e.deleteMessage(e.id),d(!0),M("restore")},action2:function(){o(!1)},actionWindowType:j,valueButton1:"Yes",valueButton2:"No"})})]})})})),y=function(e){return Object(_.jsxs)("div",{className:x.a.actionWindow,children:[Object(_.jsx)("span",{children:e.actionText}),Object(_.jsxs)("div",{className:x.a.actionWindowButtons,children:[Object(_.jsx)(m.a,{value:e.valueButton1,click:e.action1,buttonType:"actionWindow"}),"delete"===e.actionWindowType&&Object(_.jsx)(m.a,{value:e.valueButton2||"",click:e.action2,buttonType:"actionWindow"})]})]})},D=a(65),T=n.a.memo((function(e){var s=Object(t.useState)(""),a=Object(h.a)(s,2),n=a[0],o=a[1],c=Object(t.useState)(null),r=Object(h.a)(c,2),i=r[0],g=r[1],j=Object(l.c)();return Object(_.jsxs)("div",{className:p.a.messagesForm,children:[Object(_.jsx)("div",{className:p.a.messageInput,children:Object(_.jsx)(D.a,{value:n,onChange:function(e){o(e.target.value)}})}),Object(_.jsx)("div",{className:p.a.errorMessage,children:i}),Object(_.jsx)(m.a,{click:function(){!n||n.length<1?g("You can not send an empty message"):n.length>=100?g("Max length is 100 symbols"):(e.chatMessages?j(Object(d.b)(n)):j(Object(u.g)(n,e.currentDialogId)),o(""),g(null))},value:"Send message",buttonType:"sendMessage",disabled:!!e.chatMessages&&"ready"!==e.status})]})})),P=n.a.memo((function(e){var s,a,n=Object(t.useState)(!0),o=Object(h.a)(n,2),c=o[0],r=o[1],i=Object(t.useRef)(null);Object(t.useEffect)((function(){var e;c&&(null===(e=i.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[e.chatMessages,e.dialogMessages]);var g=null===(s=e.chatMessages)||void 0===s?void 0:s.map((function(s){return Object(_.jsx)(C,{id:s.userId,isMe:s.userId===e.ownerId,message:s.message,ava:s.photo,userName:s.userName,messageType:"commonChat",deleteMessage:e.deleteMessage,senderId:1,recipientId:1,restoreMessage:e.restoreMessage,ownerId:e.ownerId},s.id)})),l=null===(a=e.dialogMessages)||void 0===a?void 0:a.map((function(s){return Object(_.jsx)(C,{id:s.id,isMe:s.senderId===e.ownerId,message:s.body,ava:null,userName:s.senderName,messageType:"dialog",deleteMessage:e.deleteMessage,senderId:s.senderId,recipientId:s.recipientId,restoreMessage:e.restoreMessage,ownerId:e.ownerId},s.id.toString())}));e.status&&"error"===e.status&&console.log("Error Chat");return Object(_.jsxs)("div",{className:p.a.messagesWithInput,children:[Object(_.jsxs)("div",{className:p.a.messagesWrap,onScroll:function(e){r(!1),e.target.scrollTopMax-e.target.scrollTop<100&&r(!0)},children:["error"===(e.status&&e.status)&&Object(_.jsx)("div",{style:{color:"red",fontSize:"20px"},children:"Some error"}),g||l,Object(_.jsx)("div",{ref:i})]}),Object(_.jsx)(T,{currentDialogId:e.currentDialogId,chatMessages:e.chatMessages,status:e.status})]})})),S=n.a.memo((function(e){return Object(_.jsxs)("div",{className:c.a.chatContainer,children:[Object(_.jsx)(b,{dialogs:e.dialogs,getDialogs:e.getDialogs,getDialogMessages:e.getDialogMessages}),Object(_.jsx)(P,{chatMessages:e.chatMessages,dialogMessages:e.dialogMessages,status:e.chatStatus,ownerId:e.ownerId,currentDialogId:e.currentDialogId,deleteMessage:e.deleteMessage,restoreMessage:e.restoreMessage})]})}));s.default=S}}]);
//# sourceMappingURL=3.1be5c39e.chunk.js.map