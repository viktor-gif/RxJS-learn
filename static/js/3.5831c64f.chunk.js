(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[3],{105:function(e,s,a){e.exports={messagesWrap:"Messages_messagesWrap__3hUqa",messageWrap:"Messages_messageWrap__2ITiA",messageWrapOwner:"Messages_messageWrapOwner__1BnMH",userPhotoContainer:"Messages_userPhotoContainer__bsPsX",userName:"Messages_userName__2QUC_",message:"Messages_message__2b9gd",myMessage:"Messages_myMessage__1nJmM",postsForm:"Messages_postsForm__2ae_M",messageInput:"Messages_messageInput__3otbB",sendMessage:"Messages_sendMessage__I4_8u",userPhoto:"Messages_userPhoto__qWMuV",errorMessage:"Messages_errorMessage__Vb3nM",messagesForm:"Messages_messagesForm__T1uMJ"}},106:function(e,s,a){e.exports={chatContainer:"Chat_chatContainer__1itWt",messagesWrap:"Chat_messagesWrap__11k-Z",messageWrap:"Chat_messageWrap__23j05",messageWrapOwner:"Chat_messageWrapOwner__2skcO",userPhotoContainer:"Chat_userPhotoContainer__w2vpC",userName:"Chat_userName__1NE6V",message:"Chat_message__2Jls5",myMessage:"Chat_myMessage__11ZHY",postsForm:"Chat_postsForm__MiIG0",messageInput:"Chat_messageInput__1e4d7",sendMessage:"Chat_sendMessage__1TpcS",userPhoto:"Chat_userPhoto__1UBwE",errorMessage:"Chat_errorMessage__1yGdu",messagesInputBlock:"Chat_messagesInputBlock__2qdry"}},107:function(e,s,a){e.exports={dialogsWrap:"Dialogs_dialogsWrap__2QX5N",commonChatBtn:"Dialogs_commonChatBtn__13kzD",userName:"Dialogs_userName__1f5V2",dialog:"Dialogs_dialog__3X4yL",avatar:"Dialogs_avatar__2lVKW"}},109:function(e,s,a){"use strict";a.r(s);var t=a(1),r=a.n(t),o=a(106),n=a.n(o),c=a(107),i=a.n(c),g=a(25),l=a(5),m=a(44),u=a(30),d=a(0),_=r.a.memo((function(e){Object(t.useEffect)((function(){e.getDialogs()}),[]);var s=Object(l.c)(),a=e.dialogs,r=null===a||void 0===a?void 0:a.map((function(s){return Object(d.jsx)(j,{id:s.id,name:s.userName,url:s.photos.small,getDialogMessages:e.getDialogMessages},s.id)}));return Object(d.jsxs)("div",{className:i.a.dialogsWrap,children:[Object(d.jsx)("div",{className:i.a.commonChatBtn,children:Object(d.jsx)("button",{onClick:function(){s(u.a.cleanDialogMessages()),s(Object(m.c)())},children:"Common chat"})}),r]})})),j=r.a.memo((function(e){var s=Object(l.c)();return Object(d.jsxs)("div",{className:i.a.dialog,children:[Object(d.jsx)("div",{className:i.a.avatar,onClick:function(){s(Object(m.d)()),e.getDialogMessages(e.id),s(u.a.setDialogId(e.id))},children:Object(d.jsx)("img",{src:e.url||g.a,alt:"User"})}),Object(d.jsx)("div",{className:i.a.userName,children:e.name.slice(0,5)+"..."})]})})),h=_,b=a(9),M=a(105),p=a.n(M),O=a(8),v=r.a.memo((function(e){return console.log(e.isMe),Object(d.jsxs)("div",{className:p.a.messageWrap+" "+(e.isMe&&p.a.messageWrapOwner),children:[Object(d.jsx)("div",{className:p.a.userPhotoContainer,children:Object(d.jsx)(O.b,{to:"/profile/".concat(e.userId),children:Object(d.jsx)("img",{className:p.a.userPhoto,src:e.ava||g.a,alt:"AVA"})})}),Object(d.jsx)("div",{children:e.userName.slice(0,5)+"..."}),Object(d.jsx)("div",{className:p.a.message+" "+(e.isMe&&p.a.myMessage),children:Object(d.jsx)("span",{children:e.message})})]})})),x=r.a.memo((function(e){var s=Object(t.useState)(""),a=Object(b.a)(s,2),r=a[0],o=a[1],n=Object(t.useState)(null),c=Object(b.a)(n,2),i=c[0],g=c[1],_=Object(l.c)();return Object(d.jsxs)("div",{className:p.a.messagesForm,children:[Object(d.jsx)("div",{className:p.a.messageInput,children:Object(d.jsx)("textarea",{value:r,autoFocus:!0,onChange:function(e){o(e.target.value)}})}),Object(d.jsx)("div",{className:p.a.errorMessage,children:i}),Object(d.jsx)("button",{className:p.a.sendMessage,onClick:function(){!r||r.length<1?g("You can not send an empty message"):r.length>=100?g("Max length is 100 symbols"):(e.chatMessages?_(Object(m.b)(r)):_(Object(u.e)(r,e.currentDialogId)),o(""),g(null))},disabled:!!e.chatMessages&&"ready"!==e.status,children:"Send message"})]})})),C=r.a.memo((function(e){var s,a,r=Object(t.useState)(!0),o=Object(b.a)(r,2),n=o[0],c=o[1],i=Object(t.useRef)(null);Object(t.useEffect)((function(){var e;n&&(null===(e=i.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[e.chatMessages,e.dialogMessages]);var l=null===(s=e.chatMessages)||void 0===s?void 0:s.map((function(s){return Object(d.jsx)(v,{userId:s.userId,isMe:s.userId===e.ownerId,message:s.message,ava:s.photo,userName:s.userName},s.id)})),m=null===(a=e.dialogMessages)||void 0===a?void 0:a.map((function(s){return Object(d.jsx)(v,{userId:s.id,isMe:s.senderId===e.ownerId,message:s.body,ava:g.a,userName:s.senderName},s.id.toString())}));e.status&&"error"===e.status&&console.log("Error Chat");return Object(d.jsxs)("div",{className:p.a.messagesWithInput,children:[Object(d.jsxs)("div",{className:p.a.messagesWrap,onScroll:function(e){c(!1),e.target.scrollTopMax-e.target.scrollTop<100&&c(!0)},children:["error"===(e.status&&e.status)&&Object(d.jsx)("div",{style:{color:"red",fontSize:"20px"},children:"Some error"}),l||m,Object(d.jsx)("div",{ref:i})]}),Object(d.jsx)(x,{currentDialogId:e.currentDialogId,chatMessages:e.chatMessages,status:e.status})]})})),N=r.a.memo((function(e){return Object(d.jsxs)("div",{className:n.a.chatContainer,children:[Object(d.jsx)(h,{dialogs:e.dialogs,getDialogs:e.getDialogs,getDialogMessages:e.getDialogMessages}),Object(d.jsx)(C,{chatMessages:e.chatMessages,dialogMessages:e.dialogMessages,status:e.chatStatus,ownerId:e.ownerId,currentDialogId:e.currentDialogId})]})}));s.default=N}}]);
//# sourceMappingURL=3.5831c64f.chunk.js.map