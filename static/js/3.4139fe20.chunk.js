(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[3],{109:function(e,s,a){e.exports={messagesWrap:"Messages_messagesWrap__3hUqa",messageWrap:"Messages_messageWrap__2ITiA",messageWrapOwner:"Messages_messageWrapOwner__1BnMH",userPhotoContainer:"Messages_userPhotoContainer__bsPsX",userName:"Messages_userName__2QUC_",message:"Messages_message__2b9gd",deleteMessageButton:"Messages_deleteMessageButton__1fXmX",myMessage:"Messages_myMessage__1nJmM",postsForm:"Messages_postsForm__2ae_M",messageInput:"Messages_messageInput__3otbB",sendMessage:"Messages_sendMessage__I4_8u",userPhoto:"Messages_userPhoto__qWMuV",errorMessage:"Messages_errorMessage__Vb3nM",messagesForm:"Messages_messagesForm__T1uMJ"}},110:function(e,s,a){e.exports={chatContainer:"Chat_chatContainer__1itWt",messagesWrap:"Chat_messagesWrap__11k-Z",messageWrap:"Chat_messageWrap__23j05",messageWrapOwner:"Chat_messageWrapOwner__2skcO",userPhotoContainer:"Chat_userPhotoContainer__w2vpC",userName:"Chat_userName__1NE6V",message:"Chat_message__2Jls5",myMessage:"Chat_myMessage__11ZHY",postsForm:"Chat_postsForm__MiIG0",messageInput:"Chat_messageInput__1e4d7",sendMessage:"Chat_sendMessage__1TpcS",userPhoto:"Chat_userPhoto__1UBwE",errorMessage:"Chat_errorMessage__1yGdu",messagesInputBlock:"Chat_messagesInputBlock__2qdry"}},111:function(e,s,a){e.exports={dialogsWrap:"Dialogs_dialogsWrap__2QX5N",commonChatBtn:"Dialogs_commonChatBtn__13kzD",userName:"Dialogs_userName__1f5V2",dialog:"Dialogs_dialog__3X4yL",avatar:"Dialogs_avatar__2lVKW"}},113:function(e,s,a){"use strict";a.r(s);var t=a(1),r=a.n(t),o=a(110),n=a.n(o),c=a(111),g=a.n(c),i=a(27),l=a(6),d=a(49),m=a(20),u=a(11),_=a(0),j=r.a.memo((function(e){Object(t.useEffect)((function(){e.getDialogs()}),[]);var s=Object(l.c)(),a=e.dialogs,r=null===a||void 0===a?void 0:a.map((function(s){return Object(_.jsx)(h,{id:s.id,name:s.userName,url:s.photos.small,getDialogMessages:e.getDialogMessages},s.id)}));return Object(_.jsxs)("div",{className:g.a.dialogsWrap,children:[Object(_.jsx)("div",{className:g.a.commonChatBtn,children:Object(_.jsx)(u.a,{click:function(){s(m.b.cleanDialogMessages()),s(Object(d.c)())},value:"Common chat",buttonType:"commonChat"})}),r]})})),h=r.a.memo((function(e){var s=Object(l.c)();return Object(_.jsxs)("div",{className:g.a.dialog,children:[Object(_.jsx)("div",{className:g.a.avatar,onClick:function(){s(Object(d.d)()),e.getDialogMessages(e.id),s(m.b.setDialogId(e.id)),s(Object(m.g)(e.id))},children:Object(_.jsx)("img",{src:e.url||i.a,alt:"User"})}),Object(_.jsx)("div",{className:g.a.userName,children:e.name.slice(0,5)+"..."})]})})),M=j,b=a(7),p=a(109),O=a.n(p),v=a(9),x=r.a.memo((function(e){var s=e.isMe?e.recipientId:e.senderId;return Object(_.jsxs)("div",{className:O.a.messageWrap+" "+(e.isMe&&O.a.messageWrapOwner),children:[Object(_.jsx)("div",{className:O.a.userPhotoContainer,children:Object(_.jsx)(v.b,{to:"/profile/".concat(e.id),children:Object(_.jsx)("img",{className:O.a.userPhoto,src:e.ava||i.a,alt:"AVA"})})}),Object(_.jsx)("div",{children:e.userName}),Object(_.jsx)("div",{className:O.a.message+" "+(e.isMe&&O.a.myMessage),children:Object(_.jsx)("span",{children:e.message})}),"dialog"===e.messageType&&Object(_.jsx)(u.a,{click:function(){e.deleteMessage(e.id,s)},value:"Delete message",buttonType:"deleteMessage"})]})})),f=r.a.memo((function(e){var s=Object(t.useState)(""),a=Object(b.a)(s,2),r=a[0],o=a[1],n=Object(t.useState)(null),c=Object(b.a)(n,2),g=c[0],i=c[1],j=Object(l.c)();return Object(_.jsxs)("div",{className:O.a.messagesForm,children:[Object(_.jsx)("div",{className:O.a.messageInput,children:Object(_.jsx)("textarea",{value:r,autoFocus:!0,onChange:function(e){o(e.target.value)}})}),Object(_.jsx)("div",{className:O.a.errorMessage,children:g}),Object(_.jsx)(u.a,{click:function(){!r||r.length<1?i("You can not send an empty message"):r.length>=100?i("Max length is 100 symbols"):(e.chatMessages?j(Object(d.b)(r)):j(Object(m.f)(r,e.currentDialogId)),o(""),i(null))},value:"Send message",buttonType:"sendMessage",disabled:!!e.chatMessages&&"ready"!==e.status})]})})),C=r.a.memo((function(e){var s,a,r=Object(t.useState)(!0),o=Object(b.a)(r,2),n=o[0],c=o[1],g=Object(t.useRef)(null);Object(t.useEffect)((function(){var e;n&&(null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[e.chatMessages,e.dialogMessages]);var l=null===(s=e.chatMessages)||void 0===s?void 0:s.map((function(s){return Object(_.jsx)(x,{id:s.userId,isMe:s.userId===e.ownerId,message:s.message,ava:s.photo,userName:s.userName,messageType:"commonChat",deleteMessage:e.deleteMessage,senderId:1,recipientId:1},s.id)})),d=null===(a=e.dialogMessages)||void 0===a?void 0:a.map((function(s){return Object(_.jsx)(x,{id:s.id,isMe:s.senderId===e.ownerId,message:s.body,ava:i.a,userName:s.senderName,messageType:"dialog",deleteMessage:e.deleteMessage,senderId:s.senderId,recipientId:s.recipientId},s.id.toString())}));e.status&&"error"===e.status&&console.log("Error Chat");return Object(_.jsxs)("div",{className:O.a.messagesWithInput,children:[Object(_.jsxs)("div",{className:O.a.messagesWrap,onScroll:function(e){c(!1),e.target.scrollTopMax-e.target.scrollTop<100&&c(!0)},children:["error"===(e.status&&e.status)&&Object(_.jsx)("div",{style:{color:"red",fontSize:"20px"},children:"Some error"}),l||d,Object(_.jsx)("div",{ref:g})]}),Object(_.jsx)(f,{currentDialogId:e.currentDialogId,chatMessages:e.chatMessages,status:e.status})]})})),I=r.a.memo((function(e){return Object(_.jsxs)("div",{className:n.a.chatContainer,children:[Object(_.jsx)(M,{dialogs:e.dialogs,getDialogs:e.getDialogs,getDialogMessages:e.getDialogMessages}),Object(_.jsx)(C,{chatMessages:e.chatMessages,dialogMessages:e.dialogMessages,status:e.chatStatus,ownerId:e.ownerId,currentDialogId:e.currentDialogId,deleteMessage:e.deleteMessage})]})}));s.default=I}}]);
//# sourceMappingURL=3.4139fe20.chunk.js.map